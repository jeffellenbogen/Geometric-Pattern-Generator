<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fireworks Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 3s ease infinite;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .controls {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .control-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .control-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-item label {
            font-weight: 600;
            color: #e0e0e0;
            font-size: 0.9em;
        }

        .control-item input,
        .control-item select {
            padding: 8px 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 0.9em;
        }

        .control-item input[type="range"] {
            accent-color: #4ecdc4;
        }

        .control-item input[type="color"] {
            width: 60px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 0.9em;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #45b7d1, #96ceb4);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(69, 183, 209, 0.4);
        }

        .btn-danger {
            background: linear-gradient(45deg, #ff4757, #ff6b6b);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 71, 87, 0.4);
        }

        .canvas-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        #fireworksCanvas {
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            background: radial-gradient(circle at center, #1a1a2e 0%, #0c0c0c 100%);
            cursor: crosshair;
        }

        .info-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            border-left: 4px solid #4ecdc4;
        }

        .info-panel h3 {
            color: #4ecdc4;
            margin-bottom: 10px;
        }

        .info-panel p {
            color: #b0b0b0;
            line-height: 1.6;
        }

        .color-palette {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }

        .color-swatch {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .color-swatch:hover {
            transform: scale(1.1);
        }

        .color-swatch.selected {
            border-color: #ffffff;
            box-shadow: 0 0 0 3px #4ecdc4, 0 0 15px rgba(78, 205, 196, 0.6);
            transform: scale(1.1);
        }

        .color-swatch.selected::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 12px;
            text-shadow: 0 0 3px rgba(0, 0, 0, 0.8);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸŽ† Fireworks Generator</h1>
            <p>Create stunning fireworks displays with customizable patterns, colors, and shapes</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <div class="control-item">
                    <label for="fireworkCount">Number of Fireworks</label>
                    <input type="range" id="fireworkCount" min="1" max="20" value="5">
                    <span id="fireworkCountValue">5</span>
                </div>
                <div class="control-item">
                    <label for="fireworkSize">Overall Size</label>
                    <input type="range" id="fireworkSize" min="50" max="300" value="150">
                    <span id="fireworkSizeValue">150px</span>
                </div>
                <div class="control-item">
                    <label for="mainShape">Main Shape</label>
                    <select id="mainShape">
                        <option value="circle">Circle</option>
                        <option value="star">Star</option>
                        <option value="heart">Heart</option>
                        <option value="diamond">Diamond</option>
                        <option value="spiral">Spiral</option>
                    </select>
                </div>
                <div class="control-item">
                    <label for="subShape">Sub-component Shape</label>
                    <select id="subShape">
                        <option value="circle">Circles</option>
                        <option value="square">Squares</option>
                        <option value="triangle">Triangles</option>
                        <option value="star">Stars</option>
                        <option value="mixed">Mixed</option>
                    </select>
                </div>
            </div>

            <div class="control-group">
                <div class="control-item">
                    <label for="subComponentCount">Sub-components</label>
                    <input type="range" id="subComponentCount" min="5" max="50" value="20">
                    <span id="subComponentCountValue">20</span>
                </div>
                <div class="control-item">
                    <label for="subComponentSize">Sub-component Size</label>
                    <input type="range" id="subComponentSize" min="5" max="30" value="12">
                    <span id="subComponentSizeValue">12px</span>
                </div>
                <div class="control-item">
                    <label for="burstPattern">Burst Pattern</label>
                    <select id="burstPattern">
                        <option value="radial">Radial</option>
                        <option value="spiral">Spiral</option>
                        <option value="wave">Wave</option>
                        <option value="random">Random</option>
                    </select>
                </div>
            </div>

            <div class="control-group">
                <div class="control-item">
                    <label>Select Colors</label>
                    <div class="color-palette">
                        <div class="color-swatch selected" style="background: #ff6b6b;" data-color="#ff6b6b"></div>
                        <div class="color-swatch" style="background: #4ecdc4;" data-color="#4ecdc4"></div>
                        <div class="color-swatch" style="background: #45b7d1;" data-color="#45b7d1"></div>
                        <div class="color-swatch" style="background: #96ceb4;" data-color="#96ceb4"></div>
                        <div class="color-swatch selected" style="background: #feca57;" data-color="#feca57"></div>
                        <div class="color-swatch selected" style="background: #ff9ff3;" data-color="#ff9ff3"></div>
                        <div class="color-swatch" style="background: #a55eea;" data-color="#a55eea"></div>
                        <div class="color-swatch" style="background: #26de81;" data-color="#26de81"></div>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" id="generateBtn">Generate Fireworks</button>
                <button class="btn btn-secondary" id="exportBtn">Export SVG</button>
                <button class="btn btn-danger" id="clearBtn">Clear</button>
            </div>
        </div>

        <div class="canvas-container">
            <canvas id="fireworksCanvas" width="800" height="600"></canvas>
        </div>

        <div class="info-panel">
            <h3>ðŸŽ† Fireworks Generator Features</h3>
            <p>
                Create beautiful fireworks displays with customizable patterns, colors, and shapes. 
                Click on the canvas to place fireworks, adjust the controls to change their appearance, 
                and export your creations as SVG files for pen plotting or digital use.
            </p>
        </div>
    </div>

    <script>
        class FireworksGenerator {
            constructor() {
                this.canvas = document.getElementById('fireworksCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.fireworks = [];
                this.selectedColors = ['#ff6b6b', '#feca57', '#ff9ff3']; // Red, Yellow, Pink
                
                this.initializeControls();
                this.setupEventListeners();
                this.generateInitialFireworks();
            }

            initializeControls() {
                // Update display values for range inputs
                const rangeInputs = ['fireworkCount', 'fireworkSize', 'subComponentCount', 'subComponentSize'];
                rangeInputs.forEach(id => {
                    const input = document.getElementById(id);
                    const valueSpan = document.getElementById(id + 'Value');
                    
                    input.addEventListener('input', () => {
                        let value = input.value;
                        if (id === 'fireworkSize') value += 'px';
                        else if (id === 'subComponentSize') value += 'px';
                        valueSpan.textContent = value;
                    });
                });
            }

            setupEventListeners() {
                // Control event listeners
                document.getElementById('generateBtn').addEventListener('click', () => this.generateFireworks());
                document.getElementById('exportBtn').addEventListener('click', () => this.exportSVG());
                document.getElementById('clearBtn').addEventListener('click', () => this.clearCanvas());

                // Color selection toggle
                document.querySelectorAll('.color-swatch').forEach(swatch => {
                    swatch.addEventListener('click', () => {
                        const color = swatch.dataset.color;
                        if (swatch.classList.contains('selected')) {
                            // Deselect color
                            swatch.classList.remove('selected');
                            this.selectedColors = this.selectedColors.filter(c => c !== color);
                        } else {
                            // Select color
                            swatch.classList.add('selected');
                            this.selectedColors.push(color);
                        }
                    });
                });

                // Canvas click to add fireworks
                this.canvas.addEventListener('click', (e) => {
                    const rect = this.canvas.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    this.addFirework(x, y);
                });
            }

            getColorPalette() {
                return this.selectedColors;
            }

            generateInitialFireworks() {
                this.clearCanvas();
                const count = parseInt(document.getElementById('fireworkCount').value);
                
                for (let i = 0; i < count; i++) {
                    const x = Math.random() * (this.canvas.width - 100) + 50;
                    const y = Math.random() * (this.canvas.height - 100) + 50;
                    this.addFirework(x, y);
                }
            }

            generateFireworks() {
                this.generateInitialFireworks();
            }

            addFirework(x, y) {
                const config = this.getFireworkConfig();
                const firework = {
                    x: x,
                    y: y,
                    ...config,
                    particles: this.generateParticles(x, y, config)
                };
                this.fireworks.push(firework);
                this.drawFirework(firework);
            }

            getFireworkConfig() {
                return {
                    size: parseInt(document.getElementById('fireworkSize').value),
                    mainShape: document.getElementById('mainShape').value,
                    subShape: document.getElementById('subShape').value,
                    subComponentCount: parseInt(document.getElementById('subComponentCount').value),
                    subComponentSize: parseInt(document.getElementById('subComponentSize').value),
                    burstPattern: document.getElementById('burstPattern').value,
                    colors: this.getColorPalette()
                };
            }

            generateParticles(x, y, config) {
                const particles = [];
                const { subComponentCount, subComponentSize, mainShape, burstPattern } = config;
                const shapePoints = this.getShapePoints(x, y, config.size, mainShape, subComponentCount);

                for (let i = 0; i < subComponentCount; i++) {
                    let particleX, particleY;
                    
                    if (i < shapePoints.length) {
                        // Use shape-based positioning
                        particleX = shapePoints[i].x;
                        particleY = shapePoints[i].y;
                    } else {
                        // Fallback to burst pattern for extra particles
                        let angle, distance;
                        
                        switch (burstPattern) {
                            case 'radial':
                                angle = (i / subComponentCount) * Math.PI * 2;
                                distance = Math.random() * (config.size / 2);
                                break;
                            case 'spiral':
                                angle = (i / subComponentCount) * Math.PI * 8;
                                distance = (i / subComponentCount) * (config.size / 2);
                                break;
                            case 'wave':
                                angle = (i / subComponentCount) * Math.PI * 2;
                                distance = (config.size / 2) * (0.5 + 0.5 * Math.sin(angle * 3));
                                break;
                            case 'random':
                                angle = Math.random() * Math.PI * 2;
                                distance = Math.random() * (config.size / 2);
                                break;
                        }

                        particleX = x + Math.cos(angle) * distance;
                        particleY = y + Math.sin(angle) * distance;
                    }

                    particles.push({
                        x: particleX,
                        y: particleY,
                        size: subComponentSize + Math.random() * 5,
                        color: config.colors[Math.floor(Math.random() * config.colors.length)],
                        shape: config.subShape === 'mixed' ? 
                            ['circle', 'square', 'triangle', 'star'][Math.floor(Math.random() * 4)] : 
                            config.subShape,
                        rotation: Math.random() * Math.PI * 2
                    });
                }

                return particles;
            }

            getShapePoints(x, y, size, shape, count) {
                const points = [];
                const radius = size / 2;
                
                switch (shape) {
                    case 'circle':
                        for (let i = 0; i < count; i++) {
                            const angle = (i / count) * Math.PI * 2;
                            const distance = Math.random() * radius;
                            points.push({
                                x: x + Math.cos(angle) * distance,
                                y: y + Math.sin(angle) * distance
                            });
                        }
                        break;
                        
                    case 'star':
                        const starPoints = 5;
                        for (let i = 0; i < count; i++) {
                            const angle = (i / count) * Math.PI * 2;
                            const distance = radius * (0.3 + 0.7 * Math.abs(Math.sin(angle * starPoints / 2)));
                            points.push({
                                x: x + Math.cos(angle) * distance,
                                y: y + Math.sin(angle) * distance
                            });
                        }
                        break;
                        
                    case 'heart':
                        for (let i = 0; i < count; i++) {
                            const t = (i / count) * Math.PI * 2;
                            const heartX = 16 * Math.pow(Math.sin(t), 3);
                            const heartY = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
                            points.push({
                                x: x + (heartX * radius) / 20,
                                y: y + (heartY * radius) / 20
                            });
                        }
                        break;
                        
                    case 'diamond':
                        for (let i = 0; i < count; i++) {
                            const t = (i / count) * 4; // 4 sides of diamond
                            let px, py;
                            if (t < 1) {
                                // Top to right
                                px = t * radius;
                                py = -radius + t * radius;
                            } else if (t < 2) {
                                // Right to bottom
                                px = radius - (t - 1) * radius;
                                py = (t - 1) * radius;
                            } else if (t < 3) {
                                // Bottom to left
                                px = -(t - 2) * radius;
                                py = radius - (t - 2) * radius;
                            } else {
                                // Left to top
                                px = -radius + (t - 3) * radius;
                                py = -(t - 3) * radius;
                            }
                            points.push({
                                x: x + px + (Math.random() - 0.5) * radius * 0.3,
                                y: y + py + (Math.random() - 0.5) * radius * 0.3
                            });
                        }
                        break;
                        
                    case 'spiral':
                        for (let i = 0; i < count; i++) {
                            const t = (i / count) * Math.PI * 6; // 3 full rotations
                            const distance = (i / count) * radius;
                            points.push({
                                x: x + Math.cos(t) * distance,
                                y: y + Math.sin(t) * distance
                            });
                        }
                        break;
                }
                
                return points;
            }

            drawFirework(firework) {
                const { particles } = firework;

                // Draw particles arranged in the main shape pattern
                particles.forEach(particle => {
                    this.drawParticle(particle);
                });
            }


            drawParticle(particle) {
                const { x, y, size, color, shape, rotation } = particle;
                
                this.ctx.save();
                this.ctx.strokeStyle = color;
                this.ctx.lineWidth = 1;
                this.ctx.translate(x, y);
                this.ctx.rotate(rotation);
                
                this.ctx.beginPath();
                
                switch (shape) {
                    case 'circle':
                        this.ctx.arc(0, 0, size / 2, 0, Math.PI * 2);
                        break;
                    case 'square':
                        this.ctx.rect(-size / 2, -size / 2, size, size);
                        break;
                    case 'triangle':
                        this.ctx.moveTo(0, -size / 2);
                        this.ctx.lineTo(-size / 2, size / 2);
                        this.ctx.lineTo(size / 2, size / 2);
                        this.ctx.closePath();
                        break;
                    case 'star':
                        this.drawStarShape(0, 0, size / 2, 5);
                        break;
                }
                
                this.ctx.stroke();
                this.ctx.restore();
            }

            drawStarShape(x, y, radius, points) {
                const angle = Math.PI / points;
                this.ctx.moveTo(x, y - radius);
                
                for (let i = 0; i < points * 2; i++) {
                    const r = i % 2 === 0 ? radius : radius * 0.5;
                    const a = i * angle - Math.PI / 2;
                    this.ctx.lineTo(x + Math.cos(a) * r, y + Math.sin(a) * r);
                }
                this.ctx.closePath();
            }


            clearCanvas() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.fireworks = [];
            }

            exportSVG() {
                const svg = this.generateSVG();
                const blob = new Blob([svg], { type: 'image/svg+xml' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'fireworks-display.svg';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            generateSVG() {
                const width = this.canvas.width;
                const height = this.canvas.height;
                
                // Collect all particles and group by color
                const particlesByColor = {};
                
                this.fireworks.forEach(firework => {
                    firework.particles.forEach(particle => {
                        const color = particle.color;
                        if (!particlesByColor[color]) {
                            particlesByColor[color] = [];
                        }
                        particlesByColor[color].push(particle);
                    });
                });
                
                let svg = `<svg width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">`;
                svg += `<rect width="100%" height="100%" fill="#0c0c0c"/>`;
                
                // Create one group per color
                Object.keys(particlesByColor).forEach(color => {
                    svg += `<g id="color-${color.replace('#', '')}" stroke="${color}" fill="none" stroke-width="1">`;
                    
                    particlesByColor[color].forEach(particle => {
                        svg += this.generateParticleSVG(particle);
                    });
                    
                    svg += `</g>`;
                });
                
                svg += '</svg>';
                return svg;
            }


            generateParticleSVG(particle) {
                const { x, y, size, shape, rotation } = particle;
                
                switch (shape) {
                    case 'circle':
                        return `<circle cx="${x}" cy="${y}" r="${size/2}"/>`;
                    case 'square':
                        return `<rect x="${x - size/2}" y="${y - size/2}" width="${size}" height="${size}" transform="rotate(${rotation * 180 / Math.PI} ${x} ${y})"/>`;
                    case 'triangle':
                        const h = size * Math.sqrt(3) / 2;
                        return `<polygon points="${x},${y - h/2} ${x - size/2},${y + h/2} ${x + size/2},${y + h/2}" transform="rotate(${rotation * 180 / Math.PI} ${x} ${y})"/>`;
                    case 'star':
                        return this.generateStarSVGShape(x, y, size/2, 5, rotation);
                    default:
                        return '';
                }
            }

            generateStarSVGShape(x, y, radius, points, rotation) {
                const angle = Math.PI / points;
                let path = `M ${x} ${y - radius}`;
                
                for (let i = 0; i < points * 2; i++) {
                    const r = i % 2 === 0 ? radius : radius * 0.5;
                    const a = i * angle - Math.PI / 2;
                    path += ` L ${x + Math.cos(a) * r} ${y + Math.sin(a) * r}`;
                }
                path += ' Z';
                
                return `<path d="${path}" transform="rotate(${rotation * 180 / Math.PI} ${x} ${y})"/>`;
            }
        }

        // Initialize the fireworks generator when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new FireworksGenerator();
        });
    </script>
</body>
</html>
